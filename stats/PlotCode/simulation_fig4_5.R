library(ggplot2)

#True positive rate, False positive rate, FDR order from K = 3, 7, 15 and (0.1,0.4), (-0.1, 0.3), (0.3, 0.5) , (-0.1,1)


NM = c("3/0.1/0.4","3/-0.1/0.3","3/0.3/0.5","3/-0.1/1","7/0.1/0.4","7/-0.1/0.3","7/0.3/0.5","7/-0.1/1","12/0.1/0.4","12/-0.1/0.3","12/0.3/0.5","12/-0.1/1")

# MAST
TP_mst = c(0.0928,0.0559,0.165,0.31,0.0008,0,0.006,0.041,0,0,0.00029,0.006)
FP_mst = c(0.00215,0.002,0.005,0.007,0,0,0,0.001,0,0,0,0.00014)
FDR_mst = c(0.0226,0.037,0.03,0.023,0,0,0,0.023,0,0,0,0.023)

## averaged
TP_mst = c(0.0935477293558306,0.059422287557921,0.163277697388529,0.326946595016891, 0.000438889862535919 ,0 ,0.0044004030265657, 0.0369265104694434, 4.0131631752147e-05, 0 ,0.000600359211755526, 0.00696897226833097)
FDR_mst = c(0.0223510843397565,0.0332726168791743 ,0.0292360221937687, 0.0250555213133359, 0, 0, 0, 0.0200426996645026, 0, 0, 0 ,0.0164886515353805)

# scDD
TP_sc = c(0.077,0.0434,0.148,0.283,0,0,0.003,0.028,0,0,0,0.00029)
FP_sc = c(0.0019,0.0017,0.0036,0.0045,0,0,0,0.0004,0,0,0,0)
FDR_sc = c(0.024,0.038,0.024,0.015,0,0,0,0.015,0,0,0,0)

## averaged
TP_sc = c(0.078472367407583 ,0.0477625083933143 ,0.152223787023182 ,0.307543794763962 ,0 ,0 ,0.00192147848087754, 0.0203012141976339, 0 ,0 ,0 ,0.00104322051748999)
FDR_sc = c(0.0200777294444841, 0.0329365079365079, 0.0278499367364991, 0.0181994883327778, 0 ,0, 0, 0.00778210116731518 ,0 ,0 ,0 ,0.0192307692307692)

# DESeq2
TP_des = c(0.123,0.083,0.191,0.33,0.0096,0.0027,0.0232,0.085,0.00094,0.057,0.00326,0.057)
FP_des = c(0.0049,0.0025,0.008,0.013,0.0003,0,0.0005,0.0025,0,0.0008,0.00007,0.0008)
FDR_des = c(0.038,0.03,0.04,0.039,0.03,0,0.023,0.028,0,0.013,0.021,0.013)

## averaged
TP_des = c(0.125187940734741, 0.0875377641984881, 0.194464953305644 ,0.344520562728398 ,0.00698637937332203 ,0.00159128390529645 ,0.0205572266898797 ,0.0870107506864049 ,0.00192147253052302 ,0.000361184685769323, 0.00556355752474249 ,0.0356019108271681)
FDR_des = c(0.0385879065150305 ,0.0382300884955752 ,0.0335727839522906 ,0.035162875751485 ,0.0521978021978022, 0 ,0.0265809782910444, 0.0241730046031418 ,0 ,0 ,0.0133333333333333 ,0.0144166666666667)

# scDDboost
TP_scb = c(0.0966,0.0288,0.34,0.52,0.0316,0.0225,0.039,0.23,0,0.006,0.00065,0.027)
FP_scb = c(0,0,0.0053,0.022,0.0003,0,0,0.002,0,0,0,0)
FDR_scb = c(0,0,0.0155,0.021,0.01,0,0,0.009,0,0,0,0)

## averaged
TP_scb = c(0.156857555007189, 0.0683664831523706, 0.336601673010924, 0.529493914469864, 0.0202716314516743 ,0.0129476618162813 ,0.0438871905930861 ,0.154063337462581, 0.0108173688471546, 0.00427409569896207 ,0.0586650807845709 ,0.118452280067024)
FDR_scb = c(0.00243427458617332 ,0 ,0.0109567298011205 ,0.0226490887796029, 0.00513698630136986, 0 ,0 ,0.00447690857681433, 0 ,0, 0, 0.00153172866520788)

pdf("simuTPR.pdf", height = 6, width = 10)
par(mar=c(7,5,4,1)+.1)
ORD = order(TP_scb)
plot(TP_scb[ORD], type = "b", lwd = 2, col = "green",
     ylab = "", xaxt = 'n', xlab = "", ylim = c(-0.04,0.55))
mtext("TPR", side=2, line=2.2, cex=1.2, yaxt = 'n')
lines(TP_des[ORD] , type = "b", lwd = 2, col = "red")
lines( TP_sc[ORD] , type = "b", lwd = 2, col = "blue")
lines( TP_mst[ORD] , type = "b", lwd = 2)
axis(1, at=1:12, labels = NM[ORD],cex.axis= 1.2, las = 2)
legend("topleft", legend=c("MAST", "DESeq2", "scDD", "scDDboost"),
       col=c("black", "red", "blue","green"),lty = 1, cex = 1.2,lwd = 2)
dev.off()
polygon( c(1,1, 4.5 ,4.5) , c(-0.04,-0.005,-0.005,-0.04) , col="lightgrey",
         border=FALSE )
text( 3,  -0.02, "3" )

polygon( c(4.5,4.5, 8.5 ,8.5) , c(-0.04,-0.005,-0.005,-0.04) , col="magenta",
         border=FALSE )
text( 6.5,  -0.02, "7" )

polygon( c(8.5,8.5, 12 ,12) , c(-0.04,-0.005,-0.005,-0.04) , col="yellow",
         border=FALSE )
text( 10.5,  -0.02, "15" )
dev.off()


pdf("simuFPR.pdf", height = 6, width = 10)
par(mar=c(7,5,4,1)+.1)
plot(FP_scb, type = "b", lwd = 2, col = "green", 
     ylab = "", xaxt = 'n', xlab = "K", ylim = c(-0.025/4,0.05))
mtext("FPR", side=2, line=2.2, cex=1.2, yaxt = 'n')
lines(FP_des , type = "b", lwd = 2, col = "red")
lines( FP_sc , type = "b", lwd = 2, col = "blue")
lines( FP_mst , type = "b", lwd = 2)
#axis(1, at=1:12, cex.axis= 1.2, las = 2) 
legend("topleft", legend=c("MAST", "DESeq2", "scDD", "scDDboost"),
       col=c("black", "red", "blue","green"),lty = 1, cex = 1.2,lwd = 2)
polygon( c(1,1, 4.5 ,4.5) , c(-0.025/4,-0.001,-0.001,-0.025/4) , col="lightgrey",
         border=FALSE )
text( 3,  -0.015/4, "3" )

polygon( c(4.5,4.5, 8.5 ,8.5) , c(-0.025/4,-0.001,-0.001,-0.025/4) , col="magenta",
         border=FALSE )
text( 6.5,  -0.015/4, "7" )

polygon( c(8.5,8.5, 12 ,12) , c(-0.025/4,-0.001,-0.001,-0.025/4) , col="yellow",
         border=FALSE )
text( 10.5,  -0.015/4, "15" )
dev.off()

pdf("simuFDR.pdf", height = 6, width = 10)
par(mar=c(7,5,4,1)+.1)
plot(FDR_scb[ORD], type = "b", lwd = 2, col = "green",
ylab = "", xaxt = 'n', xlab = "", ylim = c(-0.025 / 2,0.1))
abline(a=0.05,b=0,lwd = 2,lty = 2,col = "orange")
mtext("FDR", side=2, line=2.2, cex=1.2, yaxt = 'n')
lines(FDR_des[ORD] , type = "b", lwd = 2, col = "red")
lines( FDR_sc[ORD] , type = "b", lwd = 2, col = "blue")
lines( FDR_mst[ORD] , type = "b", lwd = 2)
axis(1, at=1:12, labels = NM[ORD],cex.axis= 1.2, las = 2)
legend("topleft", legend=c("MAST", "DESeq2", "scDD", "scDDboost"),
col=c("black", "red", "blue","green"),lty = 1, cex = 1.2,lwd = 2)
dev.off()
polygon( c(1,1, 4.5 ,4.5) , c(-0.025 / 2,-0.003,-0.003,-0.025 / 2) , col="lightgrey",
border=FALSE )
text( 3,  -0.015 / 2, "3" )

polygon( c(4.5,4.5, 8.5 ,8.5) , c(-0.025 / 2,-0.003,-0.003,-0.025 / 2) , col="magenta",
border=FALSE )
text( 6.5,  -0.015 / 2, "7" )

polygon( c(8.5,8.5, 12 ,12) , c(-0.025 / 2,-0.003,-0.003,-0.025 / 2) , col="yellow",
border=FALSE )
text( 10.5,  -0.015 / 2, "15" )
dev.off()
