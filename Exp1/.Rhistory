image( zz, rep(1,length(zz)), zz, col=cls )
plot(zz)
plot( zz, rep(1,length(zz), pch=19, col=cls)
)
plot( zz, rep(1,length(zz)), pch=19, col=cls )
?plot.symbol
?symbols
op <- palette(rainbow(N, end = 0.9))
symbols(Height, Volume, circles = Girth/16, inches = FALSE, bg = 1:N,
fg = "gray30", main = "symbols(*, circles = Girth/16, bg = 1:N)")
palette(op)
})
op <- palette(rainbow(N, end = 0.9))
symbols(Height, Volume, circles = Girth/16, inches = FALSE, bg = 1:N,
fg = "gray30", main = "symbols(*, circles = Girth/16, bg = 1:N)")
palette(op)
N <- 10
op <- palette(rainbow(N, end = 0.9))
symbols(Height, Volume, circles = Girth/16, inches = FALSE, bg = 1:N,
fg = "gray30", main = "symbols(*, circles = Girth/16, bg = 1:N)")
palette(op)
?symbols
symbols( zz, rep(1,length(zz), squares=1/100, col=cls))
symbols( zz, rep(1,length(zz), squares=1/100, col=cls))
zz <- seq( -3,3, length=length(cls))
plot( zz, rep(1,length(zz)), pch=19, col=cls )
ls()
library("xlsx", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(rJava)
install.packages("rJava")
library(rJava)
install.packages("profdpm")
library(profdpm)
?`profdpm-package`
?profLinear
install.packages("mcclust")
library(mcclust)
?minbinder
?comp.psm
install.packages("DPpackage")
library(DPpackage)
?DPpackage
library(help=DPpackage)
x <- rgamma(10^4, shape=1/2)
hist(x,100)
y <- rgamma(10^4, shape=1/2)
hist( x+y, 100)
mean(x+y)
?DPlmm
?DPMlmm
?DPlmm
setwd("~/wip/scDDboost/scDDboost/Exp1")
source("try1.R")
hist(y)
hist(y,30)
plot( y, mu)
?DPlmm
data(schoolgirls)
head(schoolgirls)
dim(schoolgirls)
schoolgirls$child
?DPrandom
?DPlmm
diag(1)
source("try1.R")
source("try1.R")
fit1$state
fit$state
plot( fit$b, y)
plot( c(fit$b), y)
length(fit$b)
plot( fit$state$b, y )
source("try1.R")
names(fit)
plot(fit)
source("try1.R")
plot(fit)
plot(fit)
names(fit)
fit$mc
fit$fixed
fit$possiP
fit$mf
names(fit)
dim( fit$save.state )
length( fit$save.state )
names( fit$save.state )
head( fit$save.state$thetasave)
dim( fit$save.state$randsave)
u <- fit$save.state$randsave[100,]
head(u)
plot(u)
plot( c(u))
dev.off()
plot(u)
source("try1.R")
plot(fit)
u <- fit$save.state$randsave[100,]
plot(u)
dev.off()
plot(u)
fit$save.state$thetasave[100,]
fit$save.state$thetasave[200,]
fit$save.state$randsave[200,]
u <-fit$save.state$randsave[200,]
plot(u)
plot( u,y)
length(u)
head(u)
lenght(unlist(y))
length(unlist(u))
u
u[101]
plot( y, u[1:100])
?rnorm
source("try1.R")
plot(fit)
hist(y,30)
dev.off()
hist(y,30)
?DPlmm
names(fit$save.state)
th <- fit$save.state$thetasave
dim(th)
head(th)
mean(y)
mean( th[,1])
plot(th[,4])
acf( th[,4])
hist( th[,4])
median( th[,4])
hist( th[,2])
plot( th[,2])
mean( th[,2])
u <- fit$save.state$randsave
dim(u)
u[1,]
dim(u)
n
u <- fit$save.state$randsave[,-(n+1)]
length(u)
length( unique(u[10,]))
v <- u[300,]
length(v)
I <- outer( v, v, "=")
I <- outer(v,v,"==")
I[1:10,1:10]
mean(I)
dim(u)
mcmc$nsave
source("try1.R")
source("try1.R")
image(A)
source("try1.R")
image(A)
source("try1.R")
source("try1.R")
mean(A)
hist( c(A), 100)
image( A > .5)
image( A>.8)
mean(A)
source("try1.R")
hist(y)
hist(y,30)
dst <- dist(y)
plot(hclust(dst))
library(pam)
install.packages("pamr")
library(pamr)
?pamr
library(cluster)
?pam
as.dist
?as.dist
as.matrix(dst)
?pam
dst <- dist(y)
dst.m <- as.matrix(dst)
e <- rgamma(n,shape=1/2)
tmp <- dst.m + e %o% e
dst.star <- as.dist(tmp)
cstar <- pam(dst.star, k=5 )
plot(cstar)
names(cstar)
cstar$clustering
source("try1.R")
image(Aboot)
mean(Aboot)
mean(A)
plot( Aboot, A)
cor( c(Aboot), c(A))
mean(dst)
mean(dst)
source("try1.R")
mean(A)
mean(Aboot)
image(Aboot)
image(A)
plot(Aboot,A)
cor(Aboot,A)
cor(c(Aboot),c(A))
source("try1.R")
mean(A)
mean(Aboot)
cor( c(A), c(Aboot))
plot( A, Aboot )
names(fit)
names(fit$save.state)
head(fit$save.state$thetasave)
fit$save.state$thetasave$ncluster
nn <- fit$save.state$thetasave[,6]
head(nn)
nn <- fit$save.state$thetasave[,5
]
hist(nn)
sum(nn==5)
source("try1.R")
image(ABayes)
image(Aboot)
plot( ABayes, Aboot)
cor( c(ABayes), c(Aboot))
source("try1.R")
image(ABayes)
image(Aboot)
mean(ABayes)
mean(Aboot)
plot(ABayes,Aboot)
cor( c(ABayes), c(Aboot))
th <- fit$save.state$thetasave
dim(th)
head(th)
mean(y)
mean( th[,3])
mean(th[,1])
hist(th[,4],100)
mean( th[,4])
hist( th[,2], 100)
source("try1.R")
image(Aboot)
image(ABayes)
plot(ABayes,Aboot)
cor( c(ABayes), c(Aboot))
mean(ABayes)
mean(Aboot)
th <- fit$save.state$thetasave
head(th)
hist( th[,2], 100)
B
sum(ok)
hist(th[,5])
hist(y)
cor( c(Aboot), c(ABayes))
source("try1.R")
mean(Aboot)
mean(ABayes)
plot(Aboot, ABayes)
image(Aboot)
image(ABayes)
image(Aboot)
image(ABayes)
image(Aboot)
image(ABayes)
hist( c(ABayes))
hist( c(Aboot))
cor( c(ABayes), c(Aboot))
plot( ABayes, Aboot, pch=".")
lam
source("try1.R")
sum(ok)
plot(ABayes, Aboot)
cor( c(ABayes), c(Aboot))
mean(ABayes)
mean(Aboot)
th <- fit$save.state$thetasave
head(th)
hist( th[,1], 100)
mean(y)
hist( th[,2], 100)
hist( th[,5], 100)
hist(y)
mean(Aboot)
mean(ABayes)
source("try1.R")
mean(Aboot)
mean(ABayes)
cor( c(Aboot), c(ABayes))
plot( Aboot, ABayes)
image(Aboot)
image(ABayes)
plot( Aboot, ABayes)
source("try1.R")
mean(ABayes)
mean(Aboot)
cor( c(ABayes), c(Aboot))
sum(ok)
source("try1.R")
mean(Aboot)
mean(ABayes)
plot( Aboot, ABayes)
cor( c(Aboot), c(ABayes))
sqrt(12)
source("try1.R")
mean(ABayes)
mean(Aboot)
image(Aboot)
source("try1.R")
mean(Aboot)
image(Aboot)
plot( c(Aboot), c(ABayes))
source("try1.R")
source("try1.R")
image(ABayes)
image(Aboot)
mean(Aboot)
mean(ABayes)
plot( ABayes, Aboot)
cor( c(ABayes), c(Aboot))
source("try1.R")
image(Aboot)
image(ABayes)
plot(Aboot,ABayes)
hist( dst, 100)
median(dst)
mean(dist)
mean( dst)
cor( c(Aboot), c(ABayes))
image(Aboot)
image(ABayes)
image(Aboot)
image(ABayes)
image(Aboot)
image(ABayes)
image(Aboot)
source("try1.R")
image(Aboot)
image(ABayes)
plot(Aboot,ABayes)
cor( c(Aboot), c(ABayes) )
sum(ok)
names(fit$save.state$thetasave)
head( fit$save.state$thetasave)
hist( fit$save.state$thetasave[,5], 20 )
source("try1.R")
sum(ok)
cor( c(Aboot), c(ABayes))
plot( Aboot, ABayes)
abline(0,1,col="red")
mean(Aboot)
mean(ABayes)
plot( Aboot, ABayes, pch=".")
?hist2d
install.packages("gplots")
library(gplots)
?hist2d
u <- cbind( c(ABayes), c(Aboot))
hist2d(u)
?hist2d
hist2d( log(u+1))
range(u)
min(u)
mean(u==0)
h <- hist2d(u)
names(h)
h$counts
range( h$counts)
image( sqrt(h$counts))
image( log(h$counts))
install.packages("mcclust")
library(mcclust)
?mcclust
u <- fit$save.state$thetasave[,5]
head(u)
u <- fit$save.state$randsave
dim(u)
u[1:10,1:2]
dim(u)
colnames(u)
v <- u[1,1:100]
v
unique(v)
m <- match(v , unique(v))
head(m)
m
head(cstar$clustering)
source("try1.R")
length(cstar)
cstar
cstar$clustering
source("try1.R")
?comp.psm
dim(boot.clust)
foo <- comp.psm(boot.clust)
image(foo)
comp.psm
?mmclust
?mcclust
?minbinder
?mmclust
mn <- minbinder(foo)
mn
mode.bayes <- minbinder(ABayes)
mode.boot <- minbinder(Aboot)
max( abs(ABayes-t(ABayes)))
diag(ABayes)
isSymmetric(ABayes)
isSymmetric.matrix(ABayes)
isSymmetric.matrix(Aboot)
max( abs( diag(ABayes) - 1))
all( diag(ABayes) == 1)
diag(ABayes) <- 1; diag(Aboot) <- 1 ## removing some numerical inaccuracies
mode.bayes <- minbinder(ABayes)
mode.boot <- minbinder(Aboot)
mode.bayes
names(mode.bayes)
cb <- mode.bayes$cl
cboot <- mode.boot$cl
plot(cb,cboot)
sum( cb == cboot)
?minbinder
?medy
?medv
?maxpear
pear(boot.clust)
pear(boot.clust,Aboot)
u <- pear(boot.clust,Aboot)
names(u)
dim(u)
length(u)
head(u)
hist(u)
source("try1.R")
summary( prand.bayes)
summary( prand.boot)
hist( prand.bayes, prob=TRUE, 20)
hist( prand.boot, add=TRUE, prob=TRUE, col="blue")
?pear
?mcclust
?arandi
source("try1.R")
prand.bayes
head(bayes.clust)
dim(bayes.clust)
true.clust
arandi(bayes.clust[1,], true.clust)
for( b in 1:length(prand.bayes) )
{
prand.bayes[b] <- arandi( bayes.clust[b,] , true.clust )
}
for( b in 1:length(prand.boot) )
{
prand.boot[b] <- arandi( boot.clust[b,] , true.clust )
}
summary(prand.bayes)
summary(prand.boot)
boxplot( list(prand.bayes,prand.boot))
arandi(true.clust,true.clust)
mean(Aboot)
mean(ABayes)
source("try1.R")
summary( prand.rand)
boxplot( list( Bayes=prand.bayes, Weighted=prand.boot, Random=prand.rand ),
horizontal=TRUE )
boxplot( list( Bayes=prand.bayes, Weighted=prand.boot, Random=prand.rand ),
horizontal=TRUE, las=1 )
boxplot( rev(list( Bayes=prand.bayes, Weighted=prand.boot, Random=prand.rand )),
horizontal=TRUE, las=1 )
boxplot( rev(list( Bayes=prand.bayes, Weighted=prand.boot, Control=prand.rand )),
horizontal=TRUE, las=1, cex.axis=.8, xlab="adjusted Rand index" )
boxplot( rev(list( Bayes=prand.bayes, Weighted=prand.boot, Control=prand.rand )),
horizontal=TRUE, las=1, cex.axis=.8,
xlab="adjusted Rand index to true clustering" )
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )),
horizontal=TRUE, las=1, cex.axis=.8,
xlab="adjusted Rand index to true clustering" )
"try1.R" 142L, 3120C written
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )), horizontal=TRUE, las=1, cex.axis=.6,
xlab="adjusted Rand index to true clustering" )
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )), horizontal=TRUE, las=1, cex.axis=.5, cex.labels=.8,
xlab="adjusted Rand index to true clustering" )
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )), horizontal=TRUE, las=1, cex.axis=.5, cex.label=.8,
xlab="adjusted Rand index to true clustering" )
?par
pdf( file="try1.pdf" )
par(mfrow=c(2,2), mgp=c(2.5,.5,0), mar=c(4,3,1,1) )
image(ABayes)
image(Aboot)
plot( ABayes, Aboot )
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )), horizontal=TRUE, las=1, cex.axis=.5, cex.label=.8,
xlab="adjusted Rand index to true clustering" )
dev.off()
pdf( file="try1.pdf" )
par(mfrow=c(2,2), mgp=c(2.5,.5,0), mar=c(4,4,1,1) )
image(ABayes, axes=FALSE)
image(Aboot, axes=FALSE)
plot( ABayes, Aboot )
abline(0,1,col="red", lwd=2 )
boxplot( rev(list( Bayes_MCMC=prand.bayes, Random_Dist=prand.boot,
Control=prand.rand )), horizontal=TRUE, las=1, cex.axis=.5, cex.label=.8,
xlab="adjusted Rand index to true clustering" )
dev.off()
plot(y)
plot(y,mu)
cor( c(Aboot), c(ABayes))
pi*25*6
citation(package = "base", lib.loc = NULL)
1/36
